<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Window_Open详解 - stswordman - 博客园</title>
<link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=gdNkSiQMyBMkpTeO1ex9qW-60UbMszQItnCUpBAT3LQ1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="http://common.cnblogs.com/Skins/sea/style.css?id=20140415"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/stswordman/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/stswordman/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/stswordman/wlwmanifest.xml"/>
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'stswordman', cb_enable_mathjax=false;</script>
<script src="/bundles/blog-common.js?v=15gzXd7pJ_PNpSlGpVykf0EBaNg79HWL7oD5vVw0NGA1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="header">
	
<!--done-->
<div class="header">
	<div class="headerText">
		<a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/stswordman/">stswordman</a><br>
		人的梦想 是不会完结的
	</div>
</div>

</div>

<div id="mytopmenu" >
	
		<div id="mylinks">
<!--done-->
<a id="MyLinks1_HomeLink" class="menu" href="http://www.cnblogs.com/">博客园</a> &nbsp;
<a id="MyLinks1_MyHomeLink" class="menu" href="http://www.cnblogs.com/stswordman/">首页</a> &nbsp;
<a href="http://q.cnblogs.com" class="menu">博问</a> &nbsp;
<a href="http://home.cnblogs.com/ing/" class="menu">闪存</a> &nbsp;
<a id="MyLinks1_NewPostLink" class="menu" rel="nofollow" href="http://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a> &nbsp;
<a id="MyLinks1_ContactLink" class="menu" rel="nofollow" href="http://space.cnblogs.com/msg/send/stswordman">联系</a> &nbsp;
<a id="MyLinks1_Syndication" class="menu" href="http://www.cnblogs.com/stswordman/rss">订阅</a><a id="MyLinks1_XMLLink" href="http://www.cnblogs.com/stswordman/rss"><img src="http://www.cnblogs.com/images/xml.gif" alt="订阅" /></a>&nbsp;
<a id="MyLinks1_Admin" class="menu" rel="nofollow" href="http://i.cnblogs.com/">管理</a>
</div>
		<DIV id="mystats">
<!--done-->
随笔-198&nbsp;
评论-435&nbsp;
文章-2&nbsp;
trackbacks-13
</DIV>
	
</div>
<div id="centercontent" >
	

<div class = "post">
	<h1 class = "postTitle"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/stswordman/archive/2006/06/02/415853.html">Window_Open详解</a></h1>
	<div id="cnblogs_post_body"><span id="ArticleContent1_ArticleContent1_lblContent"><strong>&nbsp;&nbsp; 引：<a href="http://blog.csdn.net/saiyuki/archive/2005/03/15/319658.aspx" target="_blank"><span id="ArticleContent1_ArticleContent1_lblContent"><strong>Window_Open详解</strong></span></a><br>一、window.open()支持环境：<br></strong>JavaScript1.0+/JScript1.0+/Nav2+/IE3+/Opera3+<br><br><strong>二、基本语法：</strong><br>window.open(pageURL,name,parameters) <br>其中：<br>pageURL 为子窗口路径 <br>name 为子窗口句柄 <br>parameters 为窗口参数(各参数用逗号分隔) <br><br><strong>三、示例：</strong><br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;SCRIPT&gt; <br>&lt;!-- <br>window.open ('page.html','newwindow','height=100,width=400,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no') <br>//写成一行 <br>--&gt; <br>&lt;/SCRIPT&gt;<br></td>
        </tr>
    </tbody>
</table>
<br>　　脚本运行后，page.html将在新窗体newwindow中打开，宽为100，高为400，距屏顶0象素，屏左0象素，无工具条，无菜单条，无滚动条，不可调整大小，无地址栏，无状态栏。请对照。<br>　　上例中涉及的为常用的几个参数，除此以外还有很多其他参数，请见四。<br><br><strong>四、各项参数</strong><br>　　其中yes/no也可使用1/0；pixel value为具体的数值，单位象素。<br><br>参数 | 取值范围 | 说明 <br><br>alwaysLowered | yes/no | 指定窗口隐藏在所有窗口之后 <br>alwaysRaised | yes/no | 指定窗口悬浮在所有窗口之上 <br>depended | yes/no | 是否和父窗口同时关闭 <br>directories | yes/no | Nav2和3的目录栏是否可见 <br>height | pixel value | 窗口高度 <br>hotkeys | yes/no | 在没菜单栏的窗口中设安全退出热键 <br>innerHeight | pixel value | 窗口中文档的像素高度 <br>innerWidth | pixel value | 窗口中文档的像素宽度 <br>location | yes/no | 位置栏是否可见 <br>menubar | yes/no | 菜单栏是否可见 <br>outerHeight | pixel value | 设定窗口(包括装饰边框)的像素高度 <br>outerWidth | pixel value | 设定窗口(包括装饰边框)的像素宽度 <br>resizable | yes/no | 窗口大小是否可调整 <br>screenX | pixel value | 窗口距屏幕左边界的像素长度 <br>screenY | pixel value | 窗口距屏幕上边界的像素长度 <br>scrollbars | yes/no | 窗口是否可有滚动栏 <br>titlebar | yes/no | 窗口题目栏是否可见 <br>toolbar | yes/no | 窗口工具栏是否可见 <br>Width | pixel value | 窗口的像素宽度 <br>z-look | yes/no | 窗口被激活后是否浮在其它窗口之上<br><br>=====================================================<br><br><strong>【1、最基本的弹出窗口代码】 </strong><br>　　其实代码非常简单： <br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;SCRIPT LANGUAGE="javascript"&gt; <br>&lt;!-- <br>window.open ('page.html') <br>--&gt; <br>&lt;/SCRIPT&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　因为着是一段javascripts代码，所以它们应该放在&lt;SCRIPT LANGUAGE="javascript"&gt;标签和&lt;/script&gt;之间。&lt;!-- 和 --&gt;是对一些版本低的浏览器起作用，在这些老浏览器中不会将标签中的代码作为文本显示出来。要养成这个好习惯啊。 <br>　　Window.open ('page.html') 用于控制弹出新的窗口page.html，如果page.html不与主窗口在同一路径下，前面应写明路径，绝对路径(http://)和相对路径(../)均可。用单引号和双引号都可以，只是不要混用。 <br>　　这一段代码可以加入HTML的任意位置，&lt;head&gt;和&lt;/head&gt;之间可以，&lt;body&gt;间&lt;/body&gt;也可以，越前越早执行，尤其是页面代码长，又想使页面早点弹出就尽量往前放。 <br><br><strong>【2、经过设置后的弹出窗口】</strong> <br><br>　　下面再说一说弹出窗口的设置。只要再往上面的代码中加一点东西就可以了。 <br>　　我们来定制这个弹出的窗口的外观，尺寸大小，弹出的位置以适应该页面的具体情况。 <br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;SCRIPT LANGUAGE="javascript"&gt; <br>&lt;!-- <br>window.open ('page.html', 'newwindow', 'height=100, width=400, top=0,left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no') <br>//写成一行 <br>--&gt; <br>&lt;/SCRIPT&gt;</td>
        </tr>
    </tbody>
</table>
<br>参数解释： <br>&lt;SCRIPT LANGUAGE="javascript"&gt; js脚本开始； <br>window.open 弹出新窗口的命令； <br>'page.html' 弹出窗口的文件名； <br>'newwindow' 弹出窗口的名字（不是文件名），非必须，可用空''代替； <br>height=100 窗口高度； <br>width=400 窗口宽度； <br>top=0 窗口距离屏幕上方的象素值； <br>left=0 窗口距离屏幕左侧的象素值； <br>toolbar=no 是否显示工具栏，yes为显示； <br>menubar，scrollbars 表示菜单栏和滚动栏。 <br>Resizable=no 是否允许改变窗口大小，yes为允许； <br>location=no 是否显示地址栏，yes为允许； <br>status=no 是否显示状态栏内的信息（通常是文件已经打开），yes为允许； <br>&lt;/SCRIPT&gt; js脚本结束 <br><br><strong>【3、用函数控制弹出窗口】</strong> <br><br>　　下面是一个完整的代码。<br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td><br>&lt;html&gt; <br>&lt;head&gt; <br>&lt;script LANGUAGE="JavaScript"&gt; <br>&lt;!-- <br>function openwin() { window.open ("page.html", "newwindow", "height=100, width=400, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no") <br>//写成一行 <br>} <br>//--&gt; <br>&lt;/script&gt; <br>&lt;/head&gt; <br>&lt;body onload="openwin()"&gt; <br>&#8230;任意的页面内容&#8230; <br>&lt;/body&gt; <br>&lt;/html&gt;</td>
        </tr>
    </tbody>
</table>
<br>这里定义了一个函数openwin(),函数内容就是打开一个窗口。在调用它之前没有任何用途。 <br>怎么调用呢？ <br>方法一：&lt;body onload="openwin()"&gt; 浏览器读页面时弹出窗口； <br>方法二：&lt;body onunload="openwin()"&gt; 浏览器离开页面时弹出窗口； <br>方法三：用一个连接调用： <br>&lt;a href="#" onclick="openwin()"&gt;打开一个窗口&lt;/a&gt; <br>注意：使用的"#"是虚连接。 <br>方法四：用一个按钮调用： <br>&lt;input type="button" onclick="openwin()" value="打开窗口"&gt; <br><br><strong>【4、同时弹出2个窗口】 </strong><br><br>　　对源代码稍微改动一下：<br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td><br>&lt;script LANGUAGE="JavaScript"&gt; <br>&lt;!-- <br>function openwin() <br>{ window.open ("page.html", "newwindow", "height=100, width=100, top=0,left=0,toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no") <br>//写成一行 <br>window.open ("page2.html", "newwindow2", "height=100, width=100, top=100, left=100,toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no") <br>//写成一行 <br>} <br>//--&gt; <br>&lt;/script&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　为避免弹出的2个窗口覆盖，用top和left控制一下弹出的位置不要相互覆盖即可。最后用上面说过的四种方法调用即可。 <br><strong>注意：</strong>2个窗口的name(newwindows和newwindow2)不要相同，或者干脆全部为空。OK？ <br><br><strong>【5、主窗口打开文件1.htm，同时弹出小窗口page.html】</strong> <br><br>　　如下代码加入主窗口&lt;head&gt;区：<br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td><br>&lt;script language="javascript"&gt; <br>&lt;!-- <br>function openwin() <br>{window.open("page.html","","width=200,height=200") <br>} <br>//--&gt; <br>&lt;/script&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　加入&lt;body&gt;区： <br>&lt;a href="1.htm" onclick="openwin()"&gt;open&lt;/a&gt;即可。 <br><br><strong>【6、弹出的窗口之定时关闭控制】</strong> <br><br>　　下面我们再对弹出的窗口进行一些控制，效果就更好了。如果我们再将一小段代码加入弹出的页面(注意是加入到page.html的HTML中，可不是主页面中，否则&#8230;)，让它10秒后自动关闭是不是更酷了？ <br>　　首先，将如下代码加入page.html文件的&lt;head&gt;区：<br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td><br>&lt;script language="JavaScript"&gt; <br>function closeit() <br>{setTimeout("self.close()",10000) //毫秒} <br>&lt;/script&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　然后，再用&lt;body onload="closeit()"&gt; 这一句话代替page.html中原有的&lt;BODY&gt;这一句就可以了。(这一句话千万不要忘记写啊！这一句的作用是调用关闭窗口的代码，10秒钟后就自行关闭该窗口。) <br><br><strong>【7、在弹出窗口中加上一个关闭按钮】</strong> <br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;FORM&gt; <br>&lt;INPUT TYPE='BUTTON' VALUE='关闭' onClick='window.close()'&gt; <br>&lt;/FORM&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　呵呵，现在更加完美了！ <br><br><strong>【8、内包含的弹出窗口-一个页面两个窗口】</strong> <br><br>　　上面的例子都包含两个窗口，一个是主窗口，另一个是弹出的小窗口。 <br>　　通过下面的例子，你可以在一个页面内完成上面的效果。 <br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;html&gt; <br>&lt;head&gt; <br>&lt;SCRIPT LANGUAGE="JavaScript"&gt; <br>function openwin() <br>{OpenWindow=window.open("", "newwin", "height=250, width=250,toolbar=no,scrollbars="+scroll+",menubar=no"); <br>//写成一行 <br>OpenWindow.document.write("&lt;TITLE&gt;例子&lt;/TITLE&gt;") <br>OpenWindow.document.write("&lt;BODY BGCOLOR=#ffffff&gt;") <br>OpenWindow.document.write("&lt;h1&gt;Hello!&lt;/h1&gt;") <br>OpenWindow.document.write("New window opened!") <br>OpenWindow.document.write("&lt;/BODY&gt;") <br>OpenWindow.document.write("&lt;/HTML&gt;") <br>OpenWindow.document.close()} <br>&lt;/SCRIPT&gt; <br>&lt;/head&gt; <br>&lt;body&gt; <br>&lt;a href="#" onclick="openwin()"&gt;打开一个窗口&lt;/a&gt; <br>&lt;input type="button" onclick="openwin()" value="打开窗口"&gt; <br>&lt;/body&gt; <br>&lt;/html&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　看看 OpenWindow.document.write()里面的代码不就是标准的HTML吗？只要按照格式写更多的行即可。千万注意多一个标签或少一个标签就会出现错误。记得用OpenWindow.document.close()结束啊。 <br><br>【9、终极应用--弹出的窗口之Cookie控制】 <br><br>　　回想一下，上面的弹出窗口虽然酷，但是有一点小毛病(沉浸在喜悦之中，一定没有发现吧？)比如你将上面的脚本放在一个需要频繁经过的页面里(例如首页)，那么每次刷新这个页面，窗口都会弹出一次，是不是非常烦人？:-(有解决的办法吗？Yes! ;-) Follow me. <br>　　我们使用cookie来控制一下就可以了。<br>　　首先，将如下代码加入主页面HTML的&lt;HEAD&gt;区： <br>
<table class="ubb_code" border="0" cellpadding="0" cellspacing="1" width="90%">
    <tbody>
        <tr>
            <td>&lt;script&gt; <br>function openwin() <br>{window.open("page.html","","width=200,height=200")} <br>function get_cookie(Name) <br>{var search = Name + "=" <br>var returnvalue = ""; <br>if (document.cookie.length &gt; 0) { <br>offset = document.cookie.indexOf(search) <br>if (offset != -1) { <br>offset += search.length <br>end = document.cookie.indexOf(";", offset); <br>if (end == -1) <br>end = document.cookie.length; <br>returnvalue=unescape(document.cookie.substring(offset,end)) <br>} <br>} <br>return returnvalue; <br>} <br>function loadpopup(){ <br>if (get_cookie('popped')==''){ <br>openwin() <br>document.cookie="popped=yes" <br>} <br>} <br>&lt;/script&gt;</td>
        </tr>
    </tbody>
</table>
<br>　　然后，用&lt;body onload="loadpopup()"&gt;（注意不是openwin而是loadpop啊！）替换主页面中原有的&lt;BODY&gt;这一句即可。你可以试着刷新一下这个页面或重新进入该页面，窗口再也不会弹出了。真正的Pop-Only-Once！ <br>　　写到这里弹出窗口的制作和应用技巧基本上算是完成了，俺也累坏了，一口气说了这么多，希望对正在制作网页的朋友有所帮助俺就非常欣慰了。<br>　　需要注意的是，JS脚本中的的大小写最好前后保持一致。</span> <br><br><span style="color: #ff0000;">如果使用超级链接作为弹出窗口的触发控件，要注意的是：不能更改target属性(即：target=-self或不进行设置)，否则可能会弹出一个以上的窗口<br></span> </div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


	<div class = "postDesc">posted on <span id="post-date">2006-06-02 14:43</span> <a href='http://www.cnblogs.com/stswordman/'>stswordman</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="http://i.cnblogs.com/EditPosts.aspx?postid=415853" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(415853);return false;">收藏</a></div>
</div>
<script type="text/javascript">var allowComments=true,isLogined=false,cb_blogId=17632,cb_entryId=415853,cb_blogApp=currentBlogApp,cb_blogUserGuid='4751360b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2006/6/2 14:43:00';loadViewCount(cb_entryId);</script>

<a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="site_nav_under"><a href="http://www.cnblogs.com/" target="_blank" title="程序员的网上家园">博客园首页</a><a href="http://q.cnblogs.com/" target="_blank" title="程序员问答社区">博问</a><a href="http://news.cnblogs.com/" target="_blank" title="IT新闻">新闻</a><a href="http://home.cnblogs.com/ing/" target="_blank">闪存</a><a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a><a href="http://kb.cnblogs.com/" target="_blank">知识库</a></div>
<div id="ad_under_post_holder"></div>
<script type="text/javascript">
var enableGoogleAd = true;
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
fixPostBodyFormat();
loadAdUnderPost();
</script>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
loadBlogSignature();
LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
</script>
<script type="text/javascript">
    $.ajax({ url: 'http://counter.cnblogs.com/blog/post/' + cb_entryId, type: 'get', dataType: 'script', cache: true });
</script>
</div>

</div>
<div id="leftcontent">
	
		<DIV id="leftcontentcontainer">
			
<!--done-->
<div class="newsItem">
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script><br>
			<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script></DIV>
	
</div>

<!--done-->
<div class="footer">
	Powered by: <a href="http://www.cnblogs.com">博客园</a>	模板提供：<a href="http://blog.hjenglish.com">沪江博客</a>
	Copyright &copy;2014 stswordman
</div>



</body>
</html>
